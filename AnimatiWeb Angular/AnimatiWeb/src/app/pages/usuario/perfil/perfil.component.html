<div class="perfil-container">
    <h2>Mi Perfil</h2>
    <div *ngIf="errorMessage" class="error">
        {{ errorMessage }}
    </div>
    <div class="perfil-contenido">
        <div class="perfil-imagen" *ngIf="!modoEdicion">
            <img [src]="'assets/images/' + avatarSeleccionado" alt="Imagen de perfil" class="avatar-image">
        </div>
        
        <div class="perfil-imagen" *ngIf="modoEdicion">
            <img [src]="'assets/images/' + avatarEdicion" alt="Imagen de perfil" class="avatar-image">
            <div class="avatar-selector">
                <h4>Selecciona un avatar</h4>
                <div class="avatar-options">
                    <div *ngFor="let avatar of avatares; let i = index" 
                         class="avatar-option" 
                         [class.selected]="avatar === avatarEdicion"
                         (click)="seleccionarAvatar(avatar)">
                        <img [src]="'assets/images/' + avatar" [alt]="'Avatar ' + (i+1)">
                    </div>
                </div>
            </div>
        </div>
        
        <div class="perfil-info">
            <div class="perfil-datos" *ngIf="!modoEdicion">
                <p><strong>Nombre de usuario:</strong> {{ usuario.username }}</p>
                <p><strong>Nombre:</strong> {{ usuario.first_name }}</p>
                <p><strong>Apellido:</strong> {{ usuario.last_name }}</p>
                <p><strong>Email:</strong> {{ usuario.email }}</p>
                <button class="btn btn-primary btn-animati" (click)="activarEdicion()">
                    <i class="fas fa-user-edit"></i> Modificar datos
                </button>
            </div>

            <div class="perfil-datos" *ngIf="modoEdicion">
                <p><strong>Nombre de usuario:</strong> {{ usuario.username }}</p>
                <p><strong>Nombre:</strong>
                    <input [(ngModel)]="usuarioEditado.first_name" />
                </p>
                <p><strong>Apellido:</strong>
                    <input [(ngModel)]="usuarioEditado.last_name" />
                </p>
                <p><strong>Email:</strong> {{ usuario.email }}</p>
                <div class="botones-accion">
                    <button class="btn btn-secondary" (click)="cancelarEdicion()">Cancelar</button>
                    <button class="btn btn-primary btn-animati" (click)="guardarCambios()">Guardar</button>
                </div>
            </div>
        </div>
        
        <div class="opciones-perfil">
            <button (click)="irAHistorialCompras()" class="btn btn-primary btn-animati mb-3">
                <i class="fas fa-history"></i> Ver historial de compras
            </button>
            <button (click)="irACambiarContrasena()" class="btn btn-danger">
                <i class="fas fa-lock"></i> Cambiar contrase√±a
            </button>
        </div>
    </div>
</div>